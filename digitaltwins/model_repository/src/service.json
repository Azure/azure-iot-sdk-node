{
    "swagger": "2.0",
    "info": {
        "version": "v1",
        "title": "DigitalTwin Repository Service.",
        "description": "DigitalTwin Model Repository Service.",
        "contact": {
            "name": "Â© Microsoft 2019",
            "url": "http://www.microsoft.com",
            "email": "support@microsoft.com"
        }
    },
    "schemes": [
        "http"
    ],
    "paths": {
        "/models/{modelId}": {
            "get": {
                "tags": [
                    "Models"
                ],
                "summary": "Returns a DigitalTwin model object for the given \\\"id\\\".\\r\\nIf \\\"expand\\\" is present in the query parameters and \\\"id\\\" is for a capability model then it returns\\r\\nthe capability model with expanded interface definitions.",
                "operationId": "GetModel",
                "consumes": [],
                "produces": [
                    "application/ld+json"
                ],
                "parameters": [
                    {
                        "name": "repositoryId",
                        "in": "query",
                        "description": "To access private repo, repositoryId is the repo id. To access global repo, caller should not specify this value.",
                        "required": false,
                        "type": "string"
                    },
                    {
                        "name": "modelId",
                        "in": "path",
                        "description": "Model id Ex: <example>urn:contoso:com:temparaturesensor:1</example>",
                        "required": true,
                        "type": "string"
                    },
                    {
                        "name": "x-ms-client-request-id",
                        "in": "header",
                        "description": "Optional. Provides a client-generated opaque value that is recorded in the logs. Using this header is highly recommended for correlating client-side activities with requests received by the server.",
                        "required": false,
                        "type": "string"
                    },
                    {
                        "name": "api-version",
                        "in": "query",
                        "description": "Version of the Api. Must be 2019-07-01-preview",
                        "required": true,
                        "type": "string"
                    },
                    {
                        "name": "expand",
                        "in": "query",
                        "description": "Indicates whether to expand the capability model's interface definitions inline or not. This query parameter ONLY applies to Capability model.",
                        "required": false,
                        "type": "boolean",
                        "default": false
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Success",
                        "schema": {
                            "type": "object"
                        },
                        "headers": {
                            "x-ms-request-id": {
                                "description": "This header is generated by server and uniquely identifies the request that was made and can be used for troubleshooting the request.",
                                "type": "string"
                            },
                            "ETag": {
                                "description": "Etag of the model definition.",
                                "type": "string"
                            },
                            "x-ms-model-id": {
                                "description": "Id of the model returned.",
                                "type": "string"
                            },
                            "x-ms-model-publisher-id": {
                                "description": "Publisher's AAD tenant Id of the model returned.",
                                "type": "string"
                            },
                            "x-ms-model-publisher-name": {
                                "description": "Publisher's AAD tenant name of the model returned.",
                                "type": "string"
                            },
                            "x-ms-model-createdon": {
                                "description": "ISO8601 timestamp of the creation time of the model returned.",
                                "type": "string",
                                "format": "date-time"
                            },
                            "x-ms-model-lastupdated": {
                                "description": "ISO8601 timestamp of the last update time of the model returned.",
                                "type": "string",
                                "format": "date-time"
                            }
                        }
                    }
                }
            },
            "put": {
                "tags": [
                    "Models"
                ],
                "summary": "Creates or updates the DigitalTwin Model in the repository.",
                "operationId": "CreateOrUpdateMetamodel",
                "consumes": [
                    "application/ld+json",
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "parameters": [
                    {
                        "name": "modelId",
                        "in": "path",
                        "description": "Model id Ex: <example>urn:contoso:TemparatureSensor:1</example>",
                        "required": true,
                        "type": "string"
                    },
                    {
                        "name": "repositoryId",
                        "in": "query",
                        "description": "To access private repo, repositoryId is the repo id\\r\\nTo access global repo, caller should not specify this value.",
                        "required": false,
                        "type": "string"
                    },
                    {
                        "name": "x-ms-client-request-id",
                        "in": "header",
                        "description": "Optional. Provides a client-generated opaque value that is recorded in the logs. Using this header is highly recommended for correlating client-side activities with requests received by the server.",
                        "required": false,
                        "type": "string"
                    },
                    {
                        "name": "api-version",
                        "in": "query",
                        "description": "Version of the Api. Must be 2019-07-01-preview",
                        "required": true,
                        "type": "string"
                    },
                    {
                        "name": "If-Match",
                        "in": "header",
                        "description": "Used to make operation conditional for optimistic concurrency. That is, the document is updated only if the specified etag matches the current version in the database. The value should be set to the etag value of the resource.",
                        "required": false,
                        "type": "string"
                    },
                    {
                        "name": "content",
                        "in": "body",
                        "description": "Model definition in Digital Twin Definition Language format.",
                        "required": true,
                        "schema": {
                            "type": "object"
                        }
                    }
                ],
                "responses": {
                    "201": {
                        "description": "Success",
                        "headers": {
                            "x-ms-request-id": {
                                "description": "This header is generated by server and uniquely identifies the request that was made and can be used for troubleshooting the request.",
                                "type": "string"
                            },
                            "ETag": {
                                "description": "Etag of the model definition.",
                                "type": "string"
                            }
                        }
                    },
                    "204": {
                        "description": "Success",
                        "headers": {
                            "x-ms-request-id": {
                                "description": "This header is generated by server and uniquely identifies the request that was made and can be used for troubleshooting the request.",
                                "type": "string"
                            },
                            "ETag": {
                                "description": "Etag of the model definition.",
                                "type": "string"
                            }
                        }
                    },
                    "412": {
                        "description": "Client Error",
                        "headers": {
                            "x-ms-request-id": {
                                "description": "This header is generated by server and uniquely identifies the request that was made and can be used for troubleshooting the request.",
                                "type": "string"
                            }
                        }
                    }
                }
            },
            "delete": {
                "tags": [
                    "Models"
                ],
                "summary": "Deletes a digital twin model from the repository.",
                "operationId": "DeleteMetamodel",
                "consumes": [],
                "produces": [
                    "application/json"
                ],
                "parameters": [
                    {
                        "name": "modelId",
                        "in": "path",
                        "description": "Model id Ex: <example>urn:contoso:com:temparaturesensor:1</example>",
                        "required": true,
                        "type": "string"
                    },
                    {
                        "name": "repositoryId",
                        "in": "query",
                        "description": "To access private repo, repositoryId is the repo id. Delete is not allowed for public repository.",
                        "required": true,
                        "type": "string"
                    },
                    {
                        "name": "x-ms-client-request-id",
                        "in": "header",
                        "description": "Optional. Provides a client-generated opaque value that is recorded in the logs. Using this header is highly recommended for correlating client-side activities with requests received by the server.",
                        "required": false,
                        "type": "string"
                    },
                    {
                        "name": "api-version",
                        "in": "query",
                        "description": "Version of the Api. Must be 2019-07-01-preview",
                        "required": true,
                        "type": "string"
                    }
                ],
                "responses": {
                    "204": {
                        "description": "Success",
                        "headers": {
                            "x-ms-request-id": {
                                "description": "This header is generated by server and uniquely identifies the request that was made and can be used for troubleshooting the request.",
                                "type": "string"
                            }
                        }
                    }
                }
            }
        },
        "/models/search": {
            "post": {
                "tags": [
                    "Models"
                ],
                "summary": "Searches pnp models for given search options.\r\nIt searches in the \"Description, DisplayName, Comment and Id\" metadata.",
                "operationId": "Search",
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "parameters": [
                    {
                        "name": "searchOptions",
                        "in": "body",
                        "description": "Set SearchOption.searchKeyword to search models with the keyword.\r\n            Set the \"SearchOptions.modelFilterType\" to restrict to a type of DigitalTwin model (Ex: Interface or CapabilityModel).\r\n            Default it returns all the models.",
                        "required": true,
                        "schema": {
                            "$ref": "#/definitions/SearchOptions"
                        }
                    },
                    {
                        "name": "repositoryId",
                        "in": "query",
                        "description": "To access private repo, repositoryId is the repo id.\\r\\nDelete is not allowed for public repository.",
                        "required": false,
                        "type": "string"
                    },
                    {
                        "name": "x-ms-client-request-id",
                        "in": "header",
                        "description": "Optional. Provides a client-generated opaque value that is recorded in the logs. Using this header is highly recommended for correlating client-side activities with requests received by the server..",
                        "required": false,
                        "type": "string"
                    },
                    {
                        "name": "api-version",
                        "in": "query",
                        "description": "Version of the Api. Must be 2019-07-01-preview",
                        "required": true,
                        "type": "string"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Success",
                        "schema": {
                            "$ref": "#/definitions/SearchResponse"
                        },
                        "headers": {
                            "x-ms-request-id": {
                                "description": "This header is generated by server and uniquely identifies the request that was made and can be used for troubleshooting the request.",
                                "type": "string"
                            }
                        }
                    }
                }
            }
        }
    },
    "definitions": {
        "SearchOptions": {
            "type": "object",
            "properties": {
                "searchKeyword": {
                    "type": "string"
                },
                "modelFilterType": {
                    "enum": [
                        "interface",
                        "capabilityModel"
                    ],
                    "type": "string"
                },
                "continuationToken": {
                    "type": "string"
                },
                "pageSize": {
                    "format": "int32",
                    "type": "integer"
                }
            }
        },
        "SearchResponse": {
            "type": "object",
            "properties": {
                "continuationToken": {
                    "type": "string"
                },
                "results": {
                    "uniqueItems": false,
                    "type": "array",
                    "items": {
                        "$ref": "#/definitions/ModelInformation"
                    }
                }
            }
        },
        "ModelInformation": {
            "type": "object",
            "properties": {
                "comment": {
                    "type": "string"
                },
                "description": {
                    "type": "string"
                },
                "displayName": {
                    "type": "string"
                },
                "id": {
                    "type": "string"
                },
                "modelName": {
                    "type": "string"
                },
                "version": {
                    "type": "string"
                },
                "type": {
                    "enum": [
                        "interface",
                        "capabilityModel"
                    ],
                    "type": "string"
                },
                "etag": {
                    "type": "string"
                },
                "publisherId": {
                    "type": "string"
                },
                "publisherName": {
                    "type": "string"
                },
                "createdOn": {
                    "format": "date-time",
                    "type": "string"
                },
                "lastUpdated": {
                    "format": "date-time",
                    "type": "string"
                }
            }
        }
    }
}